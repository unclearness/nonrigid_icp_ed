Non-Rigid ICP with Embedded Deformation (ED)
=====================================

Python reference implementation of non‑rigid ICP using an embedded deformation graph. It provides small, reproducible demos for mesh/point‑cloud alignment:

- **Watertight demo** (`demo/demo_watertight.py`): deform a sphere mesh to the spot/cow mesh.
- **Face demo** (`demo/demo_face.py`): align a frontal face mesh to a head mesh using sparse landmarks.
- **Terrain demo** (`demo/demo_terrain.py`): align an open terrain mesh generated by perlin noise to a bended one

Project layout
--------------
- `nonrigid_icp_ed/`: core library (graph construction, losses, registration loop, I/O helpers).
- `config/`: YAML configs for the demos.
- `data/`: demo assets (meshes and landmark JSON).
- `output/`: results written by the demos (ignored by git).
- `demo/`: runnable examples.


Setup
-----
The project uses `uv` for dependency management (see `pyproject.toml`).

```bash
# Create the environment and install dependencies
uv sync

# Optionally, activate the environment for manual runs
source .venv/bin/activate  # or .venv\\Scripts\\activate on Windows
```

If you prefer `pip`, install with `pip install -e .`, but ensure a matching PyTorch wheel for your platform/GPU.

Running the demos
-----------------
All paths are relative to the repo root. Outputs are written under `output/`.
```bash
uv run python demo/demo_xxx.py
```

